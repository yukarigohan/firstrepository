; ~/rr_2017/guile/module/ice-9/psyntax.scm
;   (define-structure (syntax-object expression wrap module))
; SOは、#(syntax-object expr wrap module) という形

;(write (syntax asdf)) (newline)
;=> #(syntax-object asdf ((top)) (hygiene guile-user))

;(define-syntax syn1
;  (lambda (x) (write x)))
;(syn1 (a b c))
;=> #(syntax-object (syn1 (a b c)) ((#f top) shift) (hygiene guile-user))%

;(define-syntax syn1
;  (lambda (form)
;    (write
;    (syntax-case form ()
;      ((_ (x y z)) (syntax (x t)))))))
;(syn1 (a b c))
;=> #(syntax-object (syn1 (a b c)) ((#f top) shift) (hygiene guile-user))%
;=> (#(syntax-object a ((#f top) shift) (hygiene guile-user))
;    #(syntax-object t ((top) #(ribcage #(x y z) #((top) (top) (top))
;                               #("l-WyWFxI5n2I6PdHdQFTGJCp-275" "l-WyWFxI5n2I6PdHdQFTGJCp-276" "l-WyWFxI5n2I6PdHdQFTGJCp-277"))
;                             #(ribcage () () ())
;                             #(ribcage #(form) #((top)) #("l-WyWFxI5n2I6PdHdQFTGJCp-266")))
;                      (hygiene guile-user)))%

(define-syntax orr
  (lambda (form)
    (write
    (syntax-case form ()
      ((_ e1 e2) #'(let ((t e1)) (if t t e2))))))
  )
(let ((t #t)) (orr #f t))
; (#(syntax-object let
;   ((top) #(ribcage #(e1 e2) #((top) (top)) #("l-WNvw6gGaZhZGGiwIJoWcnm-285" "l-WNvw6gGaZhZGGiwIJoWcnm-286"))
;    #(ribcage () () ())#(ribcage #(form) #((top)) #("l-WNvw6gGaZhZGGiwIJoWcnm-277")))
;   (hygiene guile-user))
;  ((#(syntax-object t
;     ((top)
;      #(ribcage #(e1 e2) #((top) (top)) #("l-WNvw6gGaZhZGGiwIJoWcnm-285" "l-WNvw6gGaZhZGGiwIJoWcnm-286"))
;      #(ribcage () () ())
;      #(ribcage #(form) #((top)) #("l-WNvw6gGaZhZGGiwIJoWcnm-277")))
;      (hygiene guile-user))
;   #(syntax-object #f
;     ((#f top) shift #(ribcage () () ()) #(ribcage #(t) #((top)) #("l-WNvw6gGaZhZGGiwIJoWcnm-303")))
;     (hygiene guile-user))))
; (#(syntax-object if ((top) #(ribcage #(e1 e2) #((top) (top)) #("l-WNvw6gGaZhZGGiwIJoWcnm-285" "l-WNvw6gGaZhZGGiwIJoWcnm-286")) #(ribcage () () ()) #(ribcage #(form) #((top)) #("l-WNvw6gGaZhZGGiwIJoWcnm-277")))
;   (hygiene guile-user))
;   #(syntax-object t ((top) #(ribcage #(e1 e2) #((top)(top)) #("l-WNvw6gGaZhZGGiwIJoWcnm-285"
;     "l-WNvw6gGaZhZGGiwIJoWcnm-286")) #(ribcage () () ()) #(ribcage #(form) #((top))
;     #("l-WNvw6gGaZhZGGiwIJoWcnm-277"))) (hygiene guile-user))
;   #(syntax-object t ((top) #(ribcage #(e1 e2) #((top) (top)) #("l-WNvw6gGaZhZGGiwIJoWcnm-285"
;     "l-WNvw6gGaZhZGGiwIJoWcnm-286")) #(ribcage () () ()) #(ribcage #(form) #((top))
;     #("l-WNvw6gGaZhZGGiwIJoWcnm-277"))) (hygiene guile-user))
;   #(syntax-object t
;     ((#f top) shift #(ribcage () () ()) #(ribcage #(t) #((top)) #("l-WNvw6gGaZhZGGiwIJoWcnm-303")))
;     (hygiene guile-user))))
