<!DOCTYPE html>
<html>

<head>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta HTTP-EQUIV="Pragma" CONTENT="no-cache">
    <meta HTTP-EQUIV="Expires" CONTENT="-1">

    <title>Scheme code
- 56 lines - codepad</title>

    
<link href="/code.css" media="screen" rel="stylesheet" type="text/css" />


    <link href="/main.css" media="screen" rel="stylesheet" type="text/css" />
    <style type="text/css">
    
    </style>

</head>


    <body >


        <table width="100%" cellpadding="0" cellspacing="0" style="border-bottom: 1px solid #ccc; margin: 0; width: 100%; padding: 8px 8px 4px 8px;"><tr>
        <td style="text-align: left">
        <span class="logo"><a href="/">codepad</a></span>
        <nobr>
          &nbsp;&nbsp;&nbsp;<span class="menu">[ <a href="/">create a new paste</a> ]</span>
        </nobr>
        </td>
        <td style="text-align: right">
        <nobr>
          <span class="menu">
          <a href="/login">login</a>
          </span>
        <span class="menu">|</span>
        <span class="menu"><a href="/about">about</a></span>
        </nobr>
        </td>
        
        </tr></table>

<div style="margin: 8px 8px 8px 8px">

        








<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td>

<!--
<script type="text/javascript">
google_ad_client = "ca-pub-7032029939879899";
/* paste-viewer */
google_ad_slot = "3578681972";
google_ad_width = 728;
google_ad_height = 90;
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
//-->


<br/>
<table cellspacing="0" cellpadding="0" width="100%"><tr>
<td>

    <nobr><span class="heading">Link:</span><span class="menu">
    <a href="http://codepad.org/78p5P2Kj">http://codepad.org/78p5P2Kj</a>
    </span></nobr>
    <nobr><span class="menu">&nbsp;&nbsp;&nbsp;[
<a href="http://codepad.org/78p5P2Kj/raw.scm">raw code</a> |
<a href="http://codepad.org/78p5P2Kj/fork">fork</a>
]</span></nobr>
</td>
<td style="text-align: right">
<br/>
</td>
</tr></table>

<br/>

<span class="heading">Scheme</span>,
<span class="label">
pasted
on Apr 11:
</span>
<br/>


<div class="code">
<table width="100%" border="0" cellpadding="10" cellspacing="0">
<tr>

<td style="border-right: 1px solid #ccc; text-align: right; vertical-align: top">
<div class="highlight">
<pre><a style="" name="line-1">1</a>
<a style="" name="line-2">2</a>
<a style="" name="line-3">3</a>
<a style="" name="line-4">4</a>
<a style="" name="line-5">5</a>
<a style="" name="line-6">6</a>
<a style="" name="line-7">7</a>
<a style="" name="line-8">8</a>
<a style="" name="line-9">9</a>
<a style="" name="line-10">10</a>
<a style="" name="line-11">11</a>
<a style="" name="line-12">12</a>
<a style="" name="line-13">13</a>
<a style="" name="line-14">14</a>
<a style="" name="line-15">15</a>
<a style="" name="line-16">16</a>
<a style="" name="line-17">17</a>
<a style="" name="line-18">18</a>
<a style="" name="line-19">19</a>
<a style="" name="line-20">20</a>
<a style="" name="line-21">21</a>
<a style="" name="line-22">22</a>
<a style="" name="line-23">23</a>
<a style="" name="line-24">24</a>
<a style="" name="line-25">25</a>
<a style="" name="line-26">26</a>
<a style="" name="line-27">27</a>
<a style="" name="line-28">28</a>
<a style="" name="line-29">29</a>
<a style="" name="line-30">30</a>
<a style="" name="line-31">31</a>
<a style="" name="line-32">32</a>
<a style="" name="line-33">33</a>
<a style="" name="line-34">34</a>
<a style="" name="line-35">35</a>
<a style="" name="line-36">36</a>
<a style="" name="line-37">37</a>
<a style="" name="line-38">38</a>
<a style="" name="line-39">39</a>
<a style="" name="line-40">40</a>
<a style="" name="line-41">41</a>
<a style="" name="line-42">42</a>
<a style="" name="line-43">43</a>
<a style="" name="line-44">44</a>
<a style="" name="line-45">45</a>
<a style="" name="line-46">46</a>
<a style="" name="line-47">47</a>
<a style="" name="line-48">48</a>
<a style="" name="line-49">49</a>
<a style="" name="line-50">50</a>
<a style="" name="line-51">51</a>
<a style="" name="line-52">52</a>
<a style="" name="line-53">53</a>
<a style="" name="line-54">54</a>
<a style="" name="line-55">55</a>
</pre>
</div>
</td>
<td width="100%" style="vertical-align: top">
<div class="highlight"><pre><span class="c1">;; (define i 0) </span>
<span class="c1">;; (do-while (&lt; i 4) (print &quot;toto&quot;) (set! i (+ i 1)) ) </span>
<span class="c1">;; toto</span>
<span class="c1">;; toto</span>
<span class="c1">;; toto</span>
<span class="c1">;; toto</span>
<span class="p">(</span><span class="nf">define-macro</span> <span class="p">(</span><span class="nf">do-while</span> <span class="nv">pred</span> <span class="nv">b1</span> <span class="o">.</span> <span class="nv">Larg</span><span class="p">)</span>
  <span class="o">`</span><span class="p">(</span><span class="k">let </span><span class="nv">loop</span> <span class="p">()</span>
     <span class="p">(</span><span class="k">begin </span><span class="o">,</span><span class="nv">b1</span> <span class="o">,@</span><span class="nv">Larg</span><span class="p">)</span>
     <span class="p">(</span><span class="nf">when</span> <span class="o">,</span><span class="nv">pred</span> <span class="p">(</span><span class="nf">loop</span><span class="p">))))</span>


<span class="c1">;; (do (print i) (if (&lt; i 4) (print &quot;inf&quot;) (print &quot;sup&quot;)) (set! i (+ i 1)) while (&lt; i 4))</span>
<span class="c1">;; 0</span>
<span class="c1">;; inf</span>
<span class="c1">;; 1</span>
<span class="c1">;; inf</span>
<span class="c1">;; 2</span>
<span class="c1">;; inf</span>
<span class="c1">;; 3</span>
<span class="c1">;; inf</span>

<span class="p">(</span><span class="nf">define-macro</span> <span class="p">(</span><span class="k">do </span><span class="nv">b1</span> <span class="o">.</span> <span class="nv">Larg</span><span class="p">)</span>
   <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">lst</span> <span class="p">(</span><span class="nf">gensym</span><span class="p">))</span> <span class="c1">;; list</span>
	 <span class="p">(</span><span class="nf">rev-lst</span> <span class="p">(</span><span class="nf">gensym</span><span class="p">))</span> <span class="c1">;; reversed list</span>
	 <span class="p">(</span><span class="nf">pred</span> <span class="p">(</span><span class="nf">gensym</span><span class="p">))</span> <span class="c1">;; predicate</span>
	 <span class="p">(</span><span class="nf">q-while</span> <span class="p">(</span><span class="nf">gensym</span><span class="p">))</span> <span class="c1">;; MUST be (quote while)</span>
	 <span class="p">(</span><span class="nf">lst-instr</span> <span class="p">(</span><span class="nf">gensym</span><span class="p">)))</span> <span class="c1">;; instructions to execute list</span>

      <span class="o">`</span><span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="o">,</span><span class="nv">lst</span> <span class="p">(</span><span class="nf">cons</span>
		    <span class="p">(</span><span class="k">quote </span><span class="o">,</span><span class="nv">b1</span><span class="p">)</span>
		    <span class="p">(</span><span class="k">quote </span><span class="o">,</span><span class="nv">Larg</span><span class="p">)))</span> <span class="c1">;; list</span>
	     <span class="p">(</span><span class="o">,</span><span class="nv">rev-lst</span> <span class="o">&#39;</span><span class="p">())</span> <span class="c1">;; reversed list</span>
	     <span class="p">(</span><span class="o">,</span><span class="nv">pred</span> <span class="o">&#39;</span><span class="p">())</span> <span class="c1">;; predicate</span>
	     <span class="p">(</span><span class="o">,</span><span class="nv">q-while</span> <span class="o">&#39;</span><span class="p">())</span> <span class="c1">;; MUST be (quote while)</span>
	     <span class="p">(</span><span class="o">,</span><span class="nv">lst-instr</span> <span class="o">&#39;</span><span class="p">()))</span> <span class="c1">;; instructions to execute list</span>
	  
	  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="nb">length </span><span class="o">,</span><span class="nv">lst</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span>
	      <span class="s">&quot;ERROR: too few arguments: must not be less than 2&quot;</span>
	      <span class="p">(</span><span class="nf">begin</span>
		 <span class="p">(</span><span class="k">set! </span><span class="o">,</span><span class="nv">rev-lst</span> <span class="p">(</span><span class="nb">reverse </span><span class="o">,</span><span class="nv">lst</span><span class="p">))</span>
		 <span class="p">(</span><span class="k">set! </span><span class="o">,</span><span class="nv">pred</span> <span class="p">(</span><span class="nb">car </span><span class="o">,</span><span class="nv">rev-lst</span><span class="p">))</span>
		 <span class="p">(</span><span class="k">set! </span><span class="o">,</span><span class="nv">q-while</span> <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="o">,</span><span class="nv">rev-lst</span><span class="p">)))</span>
		 <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">not </span>
		      <span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nb">equal? </span><span class="o">,</span><span class="nv">q-while</span> <span class="p">(</span><span class="k">quote </span><span class="nv">while</span><span class="p">))</span>
			  <span class="p">(</span><span class="nb">equal? </span><span class="o">,</span><span class="nv">q-while</span> <span class="p">(</span><span class="k">quote </span><span class="nv">WHILE</span><span class="p">))))</span>
		     <span class="s">&quot;ERROR: WHILE key-word not found&quot;</span>
		     <span class="p">(</span><span class="nf">begin</span>
			<span class="p">(</span><span class="k">set! </span><span class="o">,</span><span class="nv">lst-instr</span> <span class="p">(</span><span class="nf">reverse</span>
					  <span class="p">(</span><span class="nb">cdr </span>
					   <span class="p">(</span><span class="nb">cdr </span><span class="o">,</span><span class="nv">rev-lst</span><span class="p">))))</span>
			<span class="p">(</span><span class="k">let </span><span class="nv">loop</span> <span class="p">()</span>
			   <span class="p">(</span><span class="nb">map </span><span class="nv">eval</span> <span class="o">,</span><span class="nv">lst-instr</span><span class="p">)</span>
			   <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">eval </span><span class="o">,</span><span class="nv">pred</span><span class="p">)</span> <span class="p">(</span><span class="nf">loop</span><span class="p">))))))))))</span>
			
</pre></div>

</td>
</tr>
</table>
</div>







</td>
</tr>
</table>


<br/><br/>
<span class="label">
<a href="http://codepad.org/78p5P2Kj/fork">Create a new paste based on this one</a>
</span>
<br/>

<br/><br/>
<a name="comments"><span class="heading">Comments:</span></a>
<p>

<form action="/78p5P2Kj/post" method="post">
  <input type="hidden" name="parent" value=""/>
  <table>
  
  <tr>
    <td>
    <textarea id="textarea" name="text" cols="50" rows="5"></textarea>
    </td>
  </tr>
  <tr>
    <td style="text-align: left">
    <input type="submit" name="submit" value="Post Comment"/>
    </td>
  </tr>
  </table>
</form>



<script type="text/javascript">
function toggle(id) {
  var el = document.getElementById(id);
  if (el.style.display != 'none') {
    el.style.display = 'none';
  } else {
    el.style.display = '';
  }
}
</script>
</div>

<script src="/js/prototype-ajax-only.js" type="text/javascript"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-447571-2");
pageTracker._initData();
pageTracker._trackPageview();
</script>
    </body>
</html>






