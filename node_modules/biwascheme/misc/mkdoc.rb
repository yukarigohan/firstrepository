require 'json'

doc = []
Dir["src/library/*.js"].each do |path|
  puts "-- #{path}"
  File.read(path).each_line do |line|
    case line.chomp
    when %r{^\s*//(.*)}
      doc << $1
    when /define_syntax\((.*?),/
      p [:sytax, $1, doc]
      doc = []
    when /define_libfunc\((.*?), ?(\d+), ?(\d+)/
      p [:procedure, $1, $2.to_i, $3.to_i, doc]
      doc = []
#    when /alias_libfunc\((.*?), ?(.*?)\)/
#      puts line
    else
      doc = []
    end
  end
end
